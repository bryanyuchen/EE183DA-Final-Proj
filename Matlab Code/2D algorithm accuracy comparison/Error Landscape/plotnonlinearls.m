clc
close all

c = 34.3;
 %c = 0.034;
 mdist = 20;
 m1 = [0;0];
 m2 = [mdist*-0.5; mdist*-0.8660254];
 m3 = [mdist*0.5; mdist*-0.8660254];   
 
 B = [[-35; 0; -38], [-35; -4; -38], [-36; 0; -39], [-36; 0; -38], [-33; 0; -37], [-35; 0; -37], [-39; 0; -37], [-34; -4; -40], [-35; -5; -40], [-35; -4; -39], [-33; -5; -38], [-36; -6; -40], [-34; -5; -39], [-34; 0; -37], [-33; -5; -39], [-32; -5; -40], [-34; -5; -39], [-33; -6; -40], [-34; -4; -39], [-33; 0; -37], [-35; 0; -40], [-32; 0; -33], [-34; 0; -40], [-32; -5; -39], [-34; 0; -37], [-34; -4; -39], [-34; 0; -38], [-35; -5; -38], [-33; -4; -38], [-35; 0; -41], [-33; 0; -37], [-34; -5; -39], [-35; 0; -39], [-35; 0; -37], [-36; 0; -38], [-35; 0; -38], [-34; 0; -37], [-35; 0; -36], [-34; 0; -36], [-35; 0; -37], [-35; 0; -36], [-35; 0; -39], [-35; 0; -37], [-34; 0; -38], [-34; 0; -35], [-35; 0; -36], [-35; 0; -37], [-35; 0; -37], [-35; 0; -38], [-36; 0; -38], [-35; 0; -38], [-35; -4; -38], [-35; 0; -37], [-35; 0; -38], [-33; 0; -36], [-36; 0; -39], [-34; -4; -40], [-36; -4; -36], [-35; 0; -38], [-34; 0; -37], [-34; 0; -38], [-36; 0; -39], [-34; 0; -38], [-34; 0; -36], [-35; 0; -39], [-35; 0; -39], [-35; 3; -40], [-35; 0; -39], [-35; 0; -38], [-37; -5; -40], [-36; 0; -41], [-35; 0; -42], [-36; -4; -40], [-34; 0; -40], [-35; -5; -40], [-35; -4; -39], [-34; -4; -39], [-34; 0; -38], [-34; -4; -40], [-35; -4; -40], [-34; -4; -39], [-35; 0; -40], [-35; -4; -39], [-36; -5; -40], [-36; -5; -41], [-36; -3; -39], [-36; -5; -40], [-35; -5; -40], [-36; -5; -39], [-35; -4; -39], [-37; 0; -41], [-35; 0; -38], [-34; 0; -40], [-35; -6; -40], [-33; -5; -40], [-31; -7; -35], [-34; -5; -40], [-35; 0; -40], [-34; -7; -40], [-32; -8; -39], [-33; -6; -40]];
 B(1,:) = B(1,:)-4; %adjustment b/c delays between time delay samples
 B(2,:) = B(2,:)+2;
 B = 0.0143*B
 
 measurements = [-0.577883;0.117166;-0.460717];
 
x = [-5:0.1:4.9];
y = [0:0.2:19.8];

y_est = zeros(100,100);
y_est_temp = zeros(100,100);
for i = 1:length(B) 
for a = 1:100
    for b = 1:100
        y_est_temp(a,b) = (B(1,1)-(1/c)*(norm([x(a);y(b)]-m1) - norm([x(a);y(b)]-m2)))...
                           * (B(2,1)-(1/c)*(norm([x(a);y(b)]-m2) - norm([x(a);y(b)]-m3))) ...
                           * (B(3,1)-(1/c)*(norm([x(a);y(b)]-m1) - norm([x(a);y(b)]-m3)));
    end
end
y_est = y_est+y_est_temp;
end

figure
contour(y,x,log(y_est.^2))
xlabel('Y Position (mm)') % x-axis label
ylabel('X Position (mm)') % y-axis label
title('Log Time Delay Stacked Residual Plot (100 samples)')
view(-90,90)
%zlim([0 1*10^-7])

